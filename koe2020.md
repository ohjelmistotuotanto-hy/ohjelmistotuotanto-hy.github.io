---
layout: page
title: Kokeen mallivastaukset ja arvosteluperusteet
inheader: no
permalink: /koe2020/
---

## Syksyn 2020 koe

N√§et kustakin teht√§vst√§ saamasi pisteet [moodlessa](https://moodle.helsinki.fi/mod/quiz/view.php?id=2126365).

### Teht√§v√§ 1

_Teht√§v√§n arvioi Petrus Peltola. Omasta arvioinnista voi tarvittaessa kysy√§ etunimi.sukunimi@helsinki.fi tai telegramissa_

### Teht√§v√§ 2

_Teht√§v√§n arvioi Kristian Krok. Omasta arvioinnista voi tarvittaessa kysy√§ etunimi.sukunimi@helsinki.fi tai telegramissa_

Hyv√§ user story sis√§lt√§√§ asiakkaan kielell√§ kuvatun, asiakkaalle tai loppuk√§ytt√§j√§lle arvoa tuottavan, toiminnallisuuden. Projektip√§√§llikk√∂ Jamin, Kaverin kirjoittama story on laaja sek√§ r√∂nsyilev√§ ja sis√§lt√§√§ kuvaukset useammasta toteutettavasta toiminnallisuudesta. Kaverin kirjaaman storyn tekstuaaliseen kuvaukseen sis√§ltyy prioriteettikuvaus, jonka perusteella pyydetyn toiminnallisuuden toteuttaminen tiedet√§√§n korkean prioriteetin teht√§v√§ksi. Storyn tulisi siis olla INVEST-kriteerist√∂n mukainen, sis√§lt√§√§ hyv√§ksymiskriteerit ja sen vaatiman ty√∂m√§√§r√§n tulisi olla osapuilleen selvill√§. 


Vastaukset pisteytettiin seuraavien kriteerien perusteella, teht√§v√§n enimm√§ispistem√§√§r√§ 4p:

- Storyn ei tulisi sis√§lt√§√§ teknist√§ jargonia, vaan toiminnallisuuden kuvauksen asiakkaan ymm√§rt√§m√§ll√§ kielell√§ (0.25p). Teknisten yksityiskohtien kuten tietokantakerroksen toteutuksen paikka on taskeina sprint backlogilla (0.25p). 
- Storylt√§ puuttuu hyv√§ksym√§kriteerit (0.25p) ja estimaatti (0.25p).
- Story on liian suuri toteutettavaksi (epiikki) 0.5p.
- Storyn kuvauksen ei tule ottaa kantaa toteutusaikatauluun (‚Äòkannattaa samantien koodata mahdollisuus...‚Äô) 0.5p.  Toteutusj√§rjestykseen vaikutetaan priorisoimalla storyja backlogilla 0.25p.
- Ei-toiminnallisia vaatimuksia, kuten verkkokaupan suorituskyky√§ ja skaalautuvuutta k√§ytt√§j√§piikkeihin, ei ole aina j√§rkev√§√§ ottaa osaksi muuta toiminnallisuutta m√§√§ritt√§v√§√§ storya (0.25p mik√§li ainoastaan eriytetty k√§ytt√§j√§piikin tarkastelu omaksi storyksi ilman mainintaa testattavuudesta). Jos ne kuitenkin ovat tarkoituksenmukaisia, ne tulee m√§√§ritell√§ muodossa jota kyet√§√§n testaamaan (0.25p), kuten:
  - ‚ÄúK√§ytt√§j√§n vasteaika saa olla korkeintaan ùë• millisekuntia 99 % tapauksista, kun sivulla on korkeintaan ùë¶ yht√§aikaista k√§ytt√§j√§√§‚Äù, miss√§ ùë•,ùë¶ ‚àà ‚Ñï.
Storyn kuvauksessa ei tule k√§ytt√§√§ ylimalkaisia ilmaisuja kuten ‚Äúmuut mahdollliset maksuvaihtoehdot‚Äú tai ‚Äùmuut toimitustavat‚Äù 0.5p.
- Story tulisi pilkkoa osiin: (pelkk√§ maininta pilkkomisesta ilman ehdotusta 0.25p TAI story jaettu taskeihin useammaksi storyksi pilkkomisen asemesta 0.25p) s.e.
  - tuotteiden maksutavat 0.25p
    - Storyssa mainitut maksutavat luottokortti, MobilePay ja muut maksutavat kannattaa pilkkoa omiksi storyiksi. N√§ist√§ eritoten muut maksutavat tarvitsevat viel√§ lis√§selvityst√§, mm. Voiko ostoksia maksaa kiilt√§vill√§ kivill√§ tai paketilla suolaa, ja jos voi, mist√§ sovellus tarkistaa k√§ypi√§ vaihtokursseja?
  - Toimitusmahdollisuudet 0.25p
    - Storyssa mainitut toimitustavat posti, UPS ja muut toimitustavat kannattaa my√∂s pilkkoa omiksi storyiksi. Erillist√§ lis√§selvityst√§ tulee tehd√§ muista maksutavoista
    - Arvostelussa ei oteta huomioon UDP-verkkoprotokollan eriytt√§mist√§ omaksi storyksi ja tuotteiden toimitusvaihtoehdoksi, vaikka t√§t√§ useammassa vastauksessa ehdotettiinkin.
- Mik√§li vastauksessa on pilkottu maksutavat ja toimitusmahdollisuudet omiksi storyiksi, pisteytet√§√§n 0.75p sijasta 1p. 
- Storyssa mainittujen ostosten toimitusosoitteen tallennuksen sek√§ varastosaldon p√§ivitt√§misen todettu kuuluvan storyn teknisiin taskeihin 0.5p.
- Vastauksessa on perattu storya INVEST-kriteerist√∂n pohjalta 0.5p (pelkk√§ maininta INVEST-kriteerist√∂st√§ 0.25p).
- Vastauksessa on esitelty parannusehdotuksia INVEST-kriteerist√∂n pohjalta 0.5p.
- Muista kurssimateriaalin pohjalta tai muutoin hyvin perustelluista huomioista voi kertaluonteisesti saada 0.25, 0.5 tai 0.75p.

### Teht√§v√§ 3

_Teht√§v√§n arvioi Jussi Laisi. Omasta arvioinnista voi tarvittaessa kysy√§ etunimi.sukunimi@helsinki.fi tai telegramissa_

### Teht√§v√§ 4

_Teht√§v√§n arvioi Silva Perander. Omasta arvioinnista voi tarvittaessa kysy√§ etunimi.sukunimi@helsinki.fi tai telegramissa_

####  MitaÃà tarkoitetaan ohjelmiston sisaÃàisellaÃà laadulla? (1p)

Ohjelman sis√§isell√§ laadulla tarkoitetaan koodin sis√§isen rakenteen hyvyytt√§. Siihen vaikuttavia seikkoja ovat mm. koodin jatkokehityksen helppous, virheiden j√§ljityksen ja korjaamisen helppous ja kuinka vaivatonta koodin toiminnallisuuden oikeellisuus varmistaminen on muutoksia teht√§ess√§.


#### MitaÃà sisaÃàisen laadun kannalta ongelmallisia asioita esimerkkikoodissa on? (2p)

Nelj√§ n√§ist√§ riitt√§√§ t√§ysiin pisteisiin:

- Backlog-luokan on konkreettinen riippuvuus BacklogReader-luokasta ja se on turhan tietoinen sen toteutuksen yksityiskohdista. (0.5p)
- Backlog-luokan metodeissa epics ja completedStories on paljon toistoa. Molemmissa metodeissa loopataan backlogin storyt l√§pi ja lis√§t√§√§n tietyn ehdon perusteella storeja palautettavaan listaan. (0.5p)
- Storyn statuksen tyyppi on String, joka antaa statuksen arvolle turhan laajan joukon vaihtoehtoja. Luokan k√§ytt√§j√§ saattaa vahingossa esimerkiksi kirjoittaa ‚ÄúCOMPLETED‚Äù statuksen pienill√§ kirjaimilla tai tehd√§ muun kirjoitusvirheen, jota ei huomata ohjelman k√§√§nn√∂ksen aikana ja joka muuttaa ohjelman suoritusta merkitt√§v√§sti. (0.5p)
- Backlog-luokka on sille kuulumattomia vastuita, kuten formatointi sen export-metodissa. T√§m√§ rikkoo single-responsibility-periaatetta. (0.5p)
- Kaikkien eri export-formaattien tuottamisen ei tulisi kuulua saman metodin/luokan vastuulle (0.5p)
- Muista huomioita (0.25-0.5p):
  - Tyyli ei t√§ysin yhten√§ist√§ esim aaltosulkujen k√§yt√∂n ja tyhjien rivien osalta
  - Storyiss√§ taskit ovat merkkijonoja, ei v√§ltt√§m√§tt√§ hyv√§ idea sill√§ taskilla ei voi olla nyt statusta, tai estimaattia
  - Sprintti ilmaistaan numerolla, onko hyv√§ idea? Ei voi esim sis√§lt√§√§ alkamis- ja p√§√§ttymisp√§iv√§√§


### Teht√§v√§ 5

_Teht√§v√§n arvioi Matti Luukkainen. Omasta arvioinnista voi tarvittaessa kysy√§ etunimi.sukunimi@helsinki.fi tai telegramissa_

####  Selit√§ miten refaktoroisit alla olevan koodin soveltaen suunnittelumalleja tai muita tilanteeseen sopivia ratkaisuja

- BacklogReader-luokan voisi refaktroida rajapinnaksi BacklogReader, jossa on metodit read ja save. Nykyiselle BacklogReader-luokalle voisi antaa nimen FileBacklogReader ja refaktoroida se toteuttamaan BacklogReader-rajapinta. Backlog-luokka saisi BacklogReader-rajapinnan toteuttavan luokan olion konstruktorissa. (0.5p)
- Backlog-luokan metodien completedStories ja epics loopit voisi korvata Stream-luokan filter-metodilla. Toinen vaihtoehto olisi toteuttaa StoryFilter-rajapinta, jolla on metodi match, joka kertoo l√§p√§iseek√∂ story-olio filtterin. T√§m√§n rajapinnan toteuttavia luokkia voisi olla CompletedFilter ja EpicFilter. Nyt filtter√∂intiin riitt√§√§ yksi metodi, jolle annetaan haluttu StoryFilter-rajapinnan toteuttava olio. Filtter√∂innin voisi my√∂s kokonaisuudessaan siirt√§√§ omaan luokkaansa. (0.5p)
- Story-luokan status-attribuutin tyypin voisi muuttaa enumiksi. (0.5p)
- Backlogin formatoinnin eri formaateissa Backlog-luokan export-metodissa voisi erist√§√§ omaksi luokakseen. (0.5p)
- Eri formaatit kannattaisi tuottaa omina abstraktin luokan BacklogFormatter template metodia hy√∂dynt√§vin√§ luokkina. Erikoistavat luokat luokat TextBacklogFormatter ja XMLBacklogFormatter. (0.5p)
- Muita ideoita: (0.25p)
  - Tyylilliset parannukset mm tyhjien rivien, v√§lily√∂ntien, kaarisulkujen paikan suhteen
  - Luokka Sprint sensijaan ett√§ ilmaistaan asia numerolla
  - Luokka Task

Alkuper√§inen koodi

```java 
public class UserStory {
    private int sprint;
    private String name;
    private int estimate;
    private String status;
    private List<String> tasks;
    public UserStory(String name, int sprint, int estimate, String status, List<String> tasks) {
        this.name = name;
        this.sprint = sprint;
        this.estimate = estimate;
        this.status = status;
        this.tasks = tasks;
    }
    public boolean done(){
       return status.equals("COMPLETED");
    }
    public void changeStatus(String status) {
        this.status = status;
    }
    public int estimate() {
        return estimate;
    }
    public String status() {
        return status;
    }
    public String name() {
        return name;
    }
}

public class BacklogReader {
    private String file;
    public BacklogReader(String file) {
        this.file = file;
    }
    public List<UserStory> readFromFile(){
        List<UserStory> items = new ArrayList<>();
        // read stories from file
        return items;
    }
    public void saveToFile(){
        // save stories to file
    }
}

public class Backlog {
    private List<UserStory> stories;
    private BacklogReader reader;
    public Backlog() {
        reader = new BacklogReader("tmc-cli");
        stories = reader.readFromFile();
    }

    public List<UserStory> completedStories() {
        ArrayList<UserStory> completed = new ArrayList<>();
        for (UserStory story : stories) {
            if ( story.done() ) {
                completed.add(story);
            }
        }
        return completed;
    }

    public List<UserStory> epics() {
        ArrayList<UserStory> epicStories = new ArrayList<>();
        for (UserStory story : stories) {
            if ( story.estimate()>20 ) {
                epicStories.add(story);
            }
        }
        return epicStories;
    }

    public String export(String format, boolean onlyRemaining) {
        String output = "";
        if ( format.equals("xml")){
            output = "<stories>";
        }
        for (UserStory story : stories) {
            if (onlyRemaining && !story.done() ) {
                continue;
            }
            if ( format.equals("text")) {
                output += story.name()+ " " + story.estimate()+ " " + story.status() + "\n";
            } else if ( format.equals("xml"))  {
                output += "<story><name>" + story.name() +
                            "</name><estimate>" + story.estimate() +
                            "</estimate><status>" + story.status() +
                          "</status><story>\n";
            } else {
                throw new IllegalArgumentException("format not supported");
            }
        }
        if ( format.equals("xml")){
            output += "</stories>";
        }
        return output;
    }
    // other methods...
}
```

Er√§s tapa refaktorida koodi:

```java
enum Status {
    NEW, STARTED, COMPLETED
}

public class Task {
    private String content;
    private boolean status;
}

public class UserStory {
    private int sprint;
    private String name;
    private int estimate;
    private Status status;
    private List<Task> tasks;
    
    public UserStory(String name, int sprint, int estimate, Status status, List<Task> tasks) {
        this.name = name;
        this.sprint = sprint;
        this.estimate = estimate;
        this.status = status;
        this.tasks = tasks;
    }
    
    public boolean done(){
       return status == Status.COMPLETED;
    }
    
    public void changeStatus(Status status) {
        this.status = status;
    }
    public int estimate() {
        return estimate;
    }
    public Status status() {
        return status;
    }
    public String name() {
        return name;
    }
}

public class Backlog {
    private List<UserStory> stories;
    private BacklogReader reader;
    
    // injektoidaan readed-olio
    public Backlog(BacklogReader reader) {
        stories = reader.read();
    }
    
    // yleinen filtter√∂intimerodi
    public List<UserStory> storiesBy(StoryFilter filter) {
        ArrayList<UserStory> filtered = new ArrayList<>();
        for (UserStory story : stories) {
            if ( filter.pass(story) ) {
                filtered.add(story);
            }
        }
  
        return filtered;
    }
    
    public List<UserStory> completedStories() {
        return storiesBy(new CompletedFilter());
    }
   
    public List<UserStory> remainingStories() {
        return storiesBy(new NotCompletedFilter());
    }    
    
    public List<UserStory> epics() {
        return storiesBy(new EpicFilter());
    }
    
    public String export(String format, boolean onlyRemaining) {
        return Exporter.getExporter(format).export(onlyRemaining ? remainingStories() : stories);
    }
    
    // other methods...
}

// reader rajapinnan taakse

public interface BacklogReader {
    List<UserStory> read();
    void save(); 
}

public class FileBacklogReader implements BacklogReader {
    private String file;
    
    public FileBacklogReader(String file) {
        this.file = file;
    }
    
    @Override
    public List<UserStory> read() {
        List<UserStory> items = new ArrayList<>();
        // read stories from file
        return items;
    }
    
    @Override
    public void save(){
        // save stories to file
    }
}

// storylistojen filtter√∂inti

interface StoryFilter {
    boolean pass(UserStory story);
}

public class EpicFilter implements StoryFilter {
    @Override
    public boolean pass(UserStory story) {
        return story.estimate()>20; 
    }  
}

public class CompletedFilter implements StoryFilter {
    @Override
    public boolean pass(UserStory story) {
        return story.done();
    }
}

// exportaus hoidetaan templatemetodia hyv√∂dyn√§ten

public abstract class Exporter {

    public static Exporter getExporter(String format) {
        if ( format.equals("text")) {
            return new TextExporter();
        } else if ( format.equals("xml"))  {
            return null;
        } else {   
            throw new IllegalArgumentException("format not supported");
        }
    }
    
    // eksporttauksen hoitava template-metodi
    public String export(List<UserStory> stories) {
        String output = prefix();
        
        for (UserStory story : stories) {
            output += exportStory(story);
        }
        
        return output +  postfix();
    }    

    protected abstract String exportStory(UserStory story);   
    protected abstract String postfix(); 
    protected abstract String prefix();
}


public class XmlExporter extends Exporter {

    @Override
    protected String exportStory(UserStory story) {
        return "<story><name>" + story.name() +
            "</name><estimate>" + story.estimate() +
            "</estimate><status>" + story.status() +
            "</status><story>\n";
    }

    @Override
    protected String postfix() {
    return "</stories>";
    }

    @Override
    protected String prefix() {
        return "<stories>";
    }
    
}


public class TextExporter extends Exporter {
    @Override
    protected String exportStory(UserStory story) {
        return story.name()+ " " + story.estimate()+ " " + story.status() + "\n";
    }

    @Override
    protected String postfix() {
        return "";
    }

    @Override
    protected String prefix() {
        return "";
    }
}
```

### Teht√§v√§t 6-

_Teht√§v√§n arvioi Moodle._ 

Huomaa, ett√§ moodle n√§ytt√§√§ oikein/v√§√§rin-teht√§vien pistem√§√§r√§n v√§√§rin. Jokainen oikein vastattu v√§itt√§m√§ tuo todellisuudessa 0.25 pistett√§.
